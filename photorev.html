<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIVOPS Labs - Photo Reveal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles/photorevstyle.css">
</head>
<body class="h-screen flex flex-col">

    <header class="h-14 bg-slate-900 border-b border-slate-800 flex items-center justify-between px-4 z-20 shadow-xl">
        <div class="flex items-center gap-3">
            <div class="bg-sky-900/20 p-1.5 rounded text-sky-500 border border-sky-900/50">
                <i data-lucide="microscope" class="w-5 h-5"></i>
            </div>
            <div>
                <h1 class="text-sky-400 font-bold tracking-widest text-sm leading-none">CIVOPS<span class="text-slate-500">LABS</span></h1>
                <span class="text-[10px] text-slate-600 uppercase tracking-widest">Photo Reveal</span>
            </div>
        </div>
        
        <div class="flex items-center gap-3">
            <div id="statusArea" class="hidden flex items-center gap-2 mr-2">
                <div id="loadingIcon" class="loader hidden"></div>
                <span id="statusText" class="text-[10px] text-sky-500 font-bold">PRONTO</span>
            </div>

            <div class="h-6 w-px bg-slate-800 mx-1"></div>

            <button id="compareBtn" class="bg-amber-900/20 border border-amber-900/50 text-amber-500 hover:bg-amber-900/40 text-xs px-3 py-1.5 rounded transition-colors font-bold select-none cursor-help disabled:opacity-50" title="Segure para ver a original">
                <i data-lucide="eye" class="w-3 h-3 inline mr-1"></i> COMPARAR
            </button>

            <button onclick="document.getElementById('fileInput').click()" class="bg-sky-700 hover:bg-sky-600 text-white text-xs px-3 py-1.5 rounded transition-colors flex items-center gap-2 font-bold shadow-lg shadow-sky-900/20">
                <i data-lucide="upload-cloud" class="w-3 h-3"></i> CARREGAR
            </button>
            <input type="file" id="fileInput" accept="image/*" class="hidden">
            
            <button id="downloadBtn" class="bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs px-3 py-1.5 rounded transition-colors border border-slate-700 disabled:opacity-50">
                <i data-lucide="save" class="w-4 h-4"></i>
            </button>
        </div>
    </header>

    <main class="flex-1 flex overflow-hidden relative">
        <aside class="w-full md:w-80 bg-slate-900 border-r border-slate-800 flex flex-col overflow-hidden z-10 flex-shrink-0 absolute md:relative h-full transition-transform duration-300" id="sidebar">
            <div class="flex border-b border-slate-800 bg-slate-950">
                <button class="flex-1 py-3 text-xs font-bold text-sky-400 border-b-2 border-sky-500 bg-slate-900">AJUSTES</button>
                <button onclick="toggleSnapshotPanel(true)" class="flex-1 py-3 text-xs font-bold text-slate-500 hover:text-slate-300 transition-colors">SNAPSHOTS</button>
            </div>

            <div class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-6" id="controlsPanel">
                <div>
                    <h3 class="text-[10px] font-bold text-slate-500 mb-2 flex items-center gap-1 uppercase tracking-widest">
                        <i data-lucide="target" class="w-3 h-3"></i> Presets Forenses
                    </h3>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="applyPreset('reset')" class="text-[10px] bg-slate-800 border border-slate-700 hover:border-slate-500 text-slate-400 py-2 px-1 rounded transition text-left pl-2">Reset / Neutro</button>
                        <button onclick="applyPreset('text_paper')" class="text-[10px] bg-slate-800 border border-sky-900/50 hover:border-sky-500 hover:bg-sky-900/20 text-sky-300 py-2 px-1 rounded transition text-left pl-2 font-bold">Texto/Papel Fino</button>
                        <button onclick="applyPreset('faint_writing')" class="text-[10px] bg-slate-800 border border-slate-700 hover:border-blue-400 hover:text-blue-300 text-slate-300 py-2 px-1 rounded transition text-left pl-2">Escrita Leve</button>
                        <button onclick="applyPreset('erased_ink')" class="text-[10px] bg-slate-800 border border-slate-700 hover:border-pink-900 hover:text-pink-400 text-slate-300 py-2 px-1 rounded transition text-left pl-2">Tinta Apagada</button>
                        <button onclick="applyPreset('invisible_mark')" class="text-[10px] bg-slate-800 border border-slate-700 hover:border-emerald-900 hover:text-emerald-400 text-slate-300 py-2 px-1 rounded transition text-left pl-2">Marcas Ocultas</button>
                        <button onclick="applyPreset('watermark')" class="text-[10px] bg-slate-800 border border-slate-700 hover:border-purple-500 text-slate-300 py-2 px-1 rounded transition text-left pl-2">Marca d'Água</button>
                    </div>
                </div>

                <div class="space-y-4 relative">
                    <div class="absolute left-[3px] top-2 bottom-2 w-px bg-slate-800 z-0"></div>
                    
                    <div class="relative z-10 pl-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-red-500"></div>
                            <span class="text-[10px] font-bold uppercase text-slate-400">1. Isolamento de Canal</span>
                        </div>
                        <div class="flex gap-1">
                             <button class="flex-1 py-1 text-[10px] border border-slate-700 bg-slate-800 text-slate-400 hover:bg-slate-700 channel-btn rounded" data-channel="all">RGB</button>
                             <button class="flex-1 py-1 text-[10px] border border-red-900/50 bg-slate-900 text-red-500 hover:bg-red-900/20 channel-btn rounded" data-channel="r">R</button>
                             <button class="flex-1 py-1 text-[10px] border border-green-900/50 bg-slate-900 text-green-500 hover:bg-green-900/20 channel-btn rounded" data-channel="g">G</button>
                             <button class="flex-1 py-1 text-[10px] border border-blue-900/50 bg-slate-900 text-blue-500 hover:bg-blue-900/20 channel-btn rounded" data-channel="b">B</button>
                        </div>
                        <div class="mt-2 flex items-center gap-2">
                            <input type="checkbox" id="check-grayscale" class="rounded bg-slate-800 border-slate-600 text-sky-600 focus:ring-0 w-3 h-3">
                            <label for="check-grayscale" class="text-[10px] text-slate-500 cursor-pointer select-none">Forçar Mono (Luminância)</label>
                        </div>
                    </div>

                    <div class="relative z-10 pl-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-yellow-500"></div>
                            <span class="text-[10px] font-bold uppercase text-slate-400">2. Luz & Tons</span>
                        </div>
                        
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-[10px] mb-1"><span>Exposição</span> <span id="val-exposure" class="text-sky-400">1.0</span></div>
                                <input type="range" min="0" max="5" step="0.05" value="1" class="range-slider" data-filter="exposure">
                            </div>
                            <div>
                                <div class="flex justify-between text-[10px] mb-1"><span>Gamma</span> <span id="val-gamma" class="text-sky-400">1.0</span></div>
                                <input type="range" min="0.1" max="4.0" step="0.05" value="1" class="range-slider" data-filter="gamma">
                            </div>
                        </div>
                    </div>

                    <div class="relative z-10 pl-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-blue-500"></div>
                            <span class="text-[10px] font-bold uppercase text-slate-400">3. Contraste (Norm.)</span>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] mb-1"><span>Intensidade</span> <span id="val-contrast" class="text-sky-400">1.0</span></div>
                            <input type="range" min="0" max="5" step="0.05" value="1" class="range-slider" data-filter="contrast">
                        </div>
                    </div>

                    <div class="relative z-10 pl-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-purple-500"></div>
                            <span class="text-[10px] font-bold uppercase text-slate-400">4. Definição</span>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] mb-1"><span>Nitidez (Kernel)</span> <span id="val-sharpen" class="text-sky-400">0</span></div>
                            <input type="range" min="0" max="20" step="1" value="0" class="range-slider" data-filter="sharpen">
                        </div>
                    </div>

                    <div class="relative z-10 pl-4 bg-slate-800/30 p-2 rounded border border-slate-800">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                            <span class="text-[10px] font-bold uppercase text-emerald-500">5. Revelação Binária</span>
                        </div>
                        
                        <div class="mb-2">
                            <select id="threshold-mode" class="w-full bg-slate-900 border border-slate-700 text-[10px] text-slate-300 rounded p-1 focus:ring-0 focus:border-sky-500">
                                <option value="manual">Manual (Slider)</option>
                                <option value="adaptive">Adaptativo (Médio)</option>
                            </select>
                        </div>

                        <div>
                            <div class="flex justify-between text-[10px] mb-1"><span>Limiar / Sensibilidade</span> <span id="val-threshold" class="text-emerald-400">OFF</span></div>
                            <input type="range" min="-1" max="255" step="1" value="-1" class="range-slider" data-filter="threshold">
                        </div>
                         <div class="mt-2 flex items-center gap-2">
                            <input type="checkbox" id="check-invert" class="rounded bg-slate-800 border-slate-600 text-emerald-600 focus:ring-0 w-3 h-3">
                            <label for="check-invert" class="text-[10px] text-slate-500 cursor-pointer select-none">Inverter Cores (Negativo)</label>
                        </div>
                    </div>

                    <div class="relative z-10 pl-4">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-1.5 h-1.5 rounded-full bg-white"></div>
                            <span class="text-[10px] font-bold uppercase text-slate-400">6. Detecção de Bordas</span>
                        </div>
                        <div class="grid grid-cols-3 gap-1">
                            <button class="edge-btn active py-1 text-[10px] border border-slate-600 bg-slate-800 text-slate-300 rounded" data-edge="none">OFF</button>
                            <button class="edge-btn py-1 text-[10px] border border-slate-800 bg-slate-900 text-slate-500 hover:text-slate-300 rounded" data-edge="sobel">Sobel Real</button>
                            <button class="edge-btn py-1 text-[10px] border border-slate-800 bg-slate-900 text-slate-500 hover:text-slate-300 rounded" data-edge="laplacian">Laplace</button>
                        </div>
                    </div>

                </div>

                <button onclick="takeSnapshot()" class="w-full mt-4 bg-slate-800 border border-slate-600 hover:border-sky-500 text-slate-300 text-xs py-2 rounded transition flex items-center justify-center gap-2">
                    <i data-lucide="camera" class="w-3 h-3"></i> CAPTURAR SNAPSHOT
                </button>

                <div class="h-8"></div>
            </div>

            <div id="snapshotsPanel" class="hidden flex-1 overflow-y-auto custom-scrollbar p-4 bg-slate-900/95 absolute inset-0 z-20 flex flex-col">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xs font-bold text-slate-400">GALERIA DE TENTATIVAS</h3>
                    <button onclick="toggleSnapshotPanel(false)" class="text-slate-500 hover:text-white"><i data-lucide="x" class="w-4 h-4"></i></button>
                </div>
                <div id="snapshotsGrid" class="space-y-3">
                    <p class="text-[10px] text-slate-600 text-center italic mt-10">Nenhum snapshot capturado.</p>
                </div>
            </div>

        </aside>

        <section class="flex-1 relative canvas-bg flex items-center justify-center overflow-hidden">
            
            <div id="emptyState" class="text-center p-12 opacity-40 select-none pointer-events-none transition-opacity duration-300">
                <div class="border-2 border-dashed border-slate-600 rounded-lg p-8 inline-block mb-4">
                    <i data-lucide="scan-line" class="w-12 h-12 text-slate-500 mx-auto"></i>
                </div>
                <h2 class="text-lg text-slate-300 font-bold tracking-widest">AGUARDANDO EVIDÊNCIA</h2>
                <p class="text-xs text-slate-500 mt-2">Arraste um arquivo ou use o botão carregar</p>
            </div>

            <div id="canvasWrapper" class="hidden shadow-2xl transition-transform origin-center cursor-move relative bg-black border border-slate-800">
                <canvas id="mainCanvas"></canvas>
            </div>

            <div class="absolute bottom-4 left-4 bg-slate-900/80 backdrop-blur border border-slate-700 p-2 rounded text-[10px] text-slate-400 font-mono z-30 pointer-events-none">
                <div id="res-info">RES: --</div>
                <div id="zoom-info">ZOOM: 100%</div>
                <div id="mode-info" class="text-sky-500 mt-1 font-bold">MODE: READY</div>
            </div>

            <div class="absolute bottom-6 right-6 flex flex-col gap-1 z-30">
                <button onclick="adjustZoom(0.1)" class="bg-slate-800 hover:bg-slate-700 text-slate-200 p-2 rounded shadow border border-slate-600"><i data-lucide="plus" class="w-4 h-4"></i></button>
                <button onclick="resetZoom()" class="bg-slate-800 hover:bg-slate-700 text-sky-400 p-2 rounded shadow border border-slate-600 text-[10px] font-bold">1:1</button>
                <button onclick="adjustZoom(-0.1)" class="bg-slate-800 hover:bg-slate-700 text-slate-200 p-2 rounded shadow border border-slate-600"><i data-lucide="minus" class="w-4 h-4"></i></button>
            </div>
            
            <div class="scanlines absolute inset-0 z-20 pointer-events-none opacity-30"></div>
        </section>
    </main>

    <script src="assets/scripts/photorevscript.js"></script>
</body>
</html>